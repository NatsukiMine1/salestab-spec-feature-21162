# ポップアップ

## 概要

家族情報カードView上でのイベントにより表示される。
続柄「子の配偶者」、「孫」、「きょうだいの配偶者」、「甥姪」、「その他パートナー」、「その他」について、以下の操作ができる。

- 家族カードを参照できる
- 家族情報詳細画面を表示できる

## 画面遷移

N/A

## 画面レイアウト図

- ポップアップ
![ポップアップ](./images/family-info-popup.png)

## 画面項目

> :point_up: 麻布支店ユーザーでログインし、顧客ID「13001003000」(家族情報カードViewのサンプル)の家族カードを表示することで確認できる。
>
> 上記２顧客で確認できない項目については、都度注釈にて顧客を指定する。

1. 閉じるボタン
    - [x] タップすると、[閉じるボタンをタップ](#閉じるボタンをタップ)を実行する。

2. 家族情報
    - 子の配偶者
        - [x] 白丸の枠を1つ表示する。
        - [x] タップした列の「子」に紐づいている場合、その「子の配偶者」を表示する。
        - [x] タップした列の「子」に紐づいていない場合、タップした箇所の「子の配偶者」を表示する。
        - [x] 続柄詳細が登録されている場合、「子の妻」、「子の夫」のいずれかを表示する。
    - 孫
        - [x] 登録されている場合、その人数分の白丸の枠と点線の枠を1つ表示する。
        - [x] 1人の「子」に紐づいた「孫」が登録されている場合、人数＋1人分の行が表示できるポップアップを表示する。
        - [x] タップした列の「子」に紐づいている場合、その「子」の「孫」を表示する。
        - [x] タップした列の子に紐づいていない場合、タップした箇所の「孫」を表示する。
        - [x] 1人の「子」に紐づいた「孫」が複数いる場合、ソートする。
            - [x] 第1ソートキー: 生年月日の昇順で評価する。
            - [x] 年月日のいずれかが不明で、`yyyymm--,yyyy--dd,yyyy----`の形式で登録されている生年月日の`--`は99として評価する。
            - [x] 年月日のいずれかが不明で、`----mmdd,----mm--,------dd`の形式で登録されている生年月日は入力なしとして評価する。
            - [x] 第2ソートキー: 年齢の降順で評価する。
            - [x] 第3ソートキー: 明細IDの昇順で評価する。（明細が作成された日が古い順）
            > :point_up: 麻布支店ユーザーでログインし、顧客ID「13001003015」（孫ソート確認用顧客）にて確認できる。
    - きょうだいの配偶者
        - [x] 白丸の枠が1つ表示される
        - [x] タップした列の「きょうだい」に紐づいている場合、その「きょうだいの配偶者」を表示する。
        - [x] タップした列の「きょうだい」に紐づいていない場合、タップした箇所の「きょうだいの配偶者」を表示する。
        - [x] 続柄詳細が登録されている場合、きょうだいの妻、きょうだいの夫のいずれかを表示する。
    - 甥姪
        - [x] 登録されている場合、その人数分の白丸の枠と点線の枠を1つ表示する。
        - [x] 1人の「きょうだい」に紐づいた甥姪が登録されている場合、人数＋1人分の行が表示できるポップアップを表示する。
        - [x] タップした列の「きょうだい」に紐づいている場合、その「きょうだい」の「甥姪」を表示する。
        - [x] タップした列の「きょうだい」に紐づいていない場合、タップした箇所の「甥姪」を表示する。
        - [x] 続柄詳細が登録されている場合、「甥」、「姪」のいずれかを表示する。
        - [x] 1人の「きょうだい」に紐づいた「甥姪」が複数いる場合、ソートする。
            - [x] 第1ソートキー: 生年月日の昇順で評価する。
            - [x] 年月日のいずれかが不明で、`yyyymm--,yyyy--dd,yyyy----`の形式で登録されている生年月日の`--`は99として評価する。
            - [x] 年月日のいずれかが不明で、`----mmdd,----mm--,------dd`の形式で登録されている生年月日は入力なしとして評価する。
            - [x] 第2ソートキー: 年齢の降順で評価する。
            - [x] 第3ソートキー: 続柄詳細は「甥」>「姪」の順で評価する。
            > :point_up: 麻布支店ユーザーでログインし、顧客ID「13001003001」（ENUMを網羅）にて確認できる。
            - [x] 第4ソートキー: 明細IDの昇順で評価する。（明細が作成された日が古い順）
            > :point_up: 麻布支店ユーザーでログインし、顧客ID「13001003016」（甥姪ソート確認用顧客）にて確認できる。
    - 他パートナー
        - [x] 登録されている場合、その人数分の白丸の枠と点線の枠を1つ表示する。
        - [x] 登録されている場合、人数＋1人分の行が表示できるポップアップを表示する。
        - [x] 続柄詳細が登録されている場合、「夫（内縁）」、「妻（内縁）」、「前夫」、「前妻」のいずれかを表示する。
        - [x] 続柄補足が登録されている場合、「離別」、「死別」のいずれかを表示する。
        - [x] 「その他パートナー」が複数いる場合、ソートする。
            - [x] 第1ソートキー: 生年月日の昇順で評価する。
            - [x] 年月日のいずれかが不明で、`yyyymm--,yyyy--dd,yyyy----`の形式で登録されている生年月日の`--`は99として評価する。
            - [x] 年月日のいずれかが不明で、`----mmdd,----mm--,------dd`の形式で登録されている生年月日は入力なしとして評価する。
            - [x] 第2ソートキー: 年齢の降順で評価する。
            - [x] 第3ソートキー: 続柄詳細は「夫（内縁）」>「妻（内縁）」>「前夫」>「前妻」の順で評価する。
                > :point_up: 麻布支店ユーザーでログインし、顧客ID「13001003001」（ENUMを網羅）にて確認できる。
            - [x] 第4ソートキー: 明細IDの昇順で評価する。（明細が作成された日が古い順）
            > :point_up: 麻布支店ユーザーでログインし、顧客ID「13001003017」（他パートナーソート確認用顧客）にて確認できる。
    - その他
        - [x] 登録されている場合、その人数分の白丸の枠と点線の枠を1つ表示する。
        - [x] 登録されている場合、人数＋1人分の行が表示できるポップアップを表示する。
        - [x] 「その他」が複数いる場合、ソートする。
            - [x] 第1ソートキー第1ソートキー: 生年月日の昇順で評価する。
            - [x] `yyyymm--,yyyy--dd,yyyy----`の形式で登録されている生年月日の`--`は99として評価する。
            - [x] `----mmdd,----mm--.------dd`の形式で登録されている生年月日は入力なしとして評価する。
            - [x] 第2ソートキー: 年齢の降順で評価する。
            - [x] 第3ソートキー: 続柄詳細は「祖父」>祖母」>「養父」>「養母」>「義父」>「義母」>「おじ」>「おば」>「甥姪の夫」>「甥姪の妻」>「孫の夫」>「孫の妻」>「ひ孫」>「その他」順で評価する。
            > :point_up: 麻布支店ユーザーでログインし、顧客ID「13001003001」（ENUMを網羅）にて確認できる。
            - [x] 第4ソートキー: 明細IDの昇順で評価する。（明細が作成された日が古い順）
            > :point_up: 麻布支店ユーザーでログインし、顧客ID「13001003018」（その他ソート確認用顧客）にて確認できる。
    - [x] 登録されている場合、白丸の枠で表示し、タップすると[白丸の枠をタップ](#白丸の枠をタップ)を実行する。
    - [x] 登録されていない場合、点線の枠で表示し、タップすると[点線の枠をタップ](#点線の枠をタップ)を実行する。

## イベント

この項では、当画面にて実行されるイベント一覧を記述する。

### 家族情報カードViewの表示

[家族情報カードView](家族情報カードView.md)を表示する。

#### 閉じるボタンをタップ

ー [x] ポップアップを閉じ、家族情報カードViewを表示する。

### 家族情報詳細画面の表示

[家族情報詳細画面](家族情報詳細.md)を表示する。

#### 白丸の枠をタップ

- [x] タップした家族の情報を顧客情報詳細画面に渡す。
- [x] [家族情報詳細画面](家族情報詳細.md)を表示する。

#### 点線の枠をタップ

- [x] タップした箇所の続柄を顧客情報詳細画面に渡す。
- [x] [家族情報詳細画面](家族情報詳細.md)を表示する。
