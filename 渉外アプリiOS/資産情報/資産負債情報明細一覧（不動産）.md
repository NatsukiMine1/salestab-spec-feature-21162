# 資産負債情報明細一覧（不動産）

## 概要

資産負債情報の明細（不動産）を確認するための画面

## 画面遷移

N/A

## 画面レイアウト図

- 資産負債情報明細一覧（不動産）View
![資産負債情報明細一覧（不動産）View](images/資産負債情報明細一覧（不動産）.drawio.png)

## 画面項目

> :point_up: 麻布支店ユーザーでログインし、顧客ID"13001003000"の資産負債収入情報トップ画面のうち、不動産カードをタップすることで確認できる。

1. ヘッダー
    - [x] 資産負債情報リンク
        - [x] タップすると、[資産負債収入情報トップ画面への遷移イベント](#資産負債収入情報トップ画面への遷移)を実行する。
    - [x] 画面名
        - [x] "明細（不動産）"を表示する。
    - [x] 顧客情報
        - [x] 顧客詳細画面にて表示されている対象顧客の氏名と年齢を表示する。
        - [x] 顧客詳細画面にて年齢が表示されていない場合、年齢（-歳）を表示する。
    - [x] 編集ボタン
        - [x] タップすると、編集モードで画面を表示する。編集ボタンが完了ボタンに反転し、資産負債情報リンクは非表示となる。明細カードの左側にマイナスサークルボタンが表示される。
        ![編集_資産負債情報明細一覧（不動産）View](images/編集_資産負債情報明細一覧（預金・投資商品）.drawio.png)
    - [x] 個人CRMリンク
        - [x] タップすると[個人CRMへの遷移イベント](#個人CRMへの遷移)を実行する。
2. 画面名
    - [x] ~~"不動産"を表示する。~~ （分類はナビゲーションバーに表示するため削除）
3. 不動産エリア
    - [x] ヘッダー
        - [x] ヒアリング情報
            - [x] 明細が存在しない場合、何も表示しない。
            - [x] 明細が存在する場合、明細のうち最終更新情報を表示する。
                - [x] ヒアリング
                    - [x] 分類が"不動産"の明細のうち最終更新日時が最も新しいものの、最終更新年月日を`YYYY.MM.DD`の形式で表示する。
                - [x] 更新者
                    - [x] 分類が"不動産"の明細のうち最終更新日時が最も新しいものの、更新者情報を`支店名・R2ID・更新者名`の形式で表示する。
                    - [x] 更新者が退職済みの場合、所属店名、R2ID、更新者氏名を表示する。
                    - [x] 所属店名が不明な場合、「不明な支店」を表示する。
        - [x] 明細追加ボタン
            - [x] "＋"ボタンを表示する。
            - [x] タップすると[追加ボタンをタップ](#追加ボタンをタップ)を実行する。
    - [x] 明細カード
        - [x] 明細が存在しない場合は、"ヒアリングして+ボタンから更新しましょう"が表示される。
        - [x] 明細が存在する場合は、明細情報と合計金額情報が表示される。
            - [x] 明細が複数存在する場合は、明細が追加された順（明細ID）の昇順でソートされていること。
            - [x] 編集モード（各明細にマイナスサークルボタンが表示された状態）で明細をタップすると明細追加・編集ダイアログ（不動産）に遷移する。
            - [x] 明細情報
                - [x] マイナスサークルボタン
                    - [x] ヘッダーの編集ボタンをタップすると出現する。
                    - [x] マイナスサークルボタンをタップすると、非表示になり、明細右端に削除ボタンを表示する。
                    - [x] 削除ボタンが表示された状態で明細をタップすると再表示する。
                - [x] 分類
                    - [x] 使用状況に応じて、"自用"（橙）, "収益不動産"（緑）, "駐車場・更地"（青）, "その他"（紫）が表示される。
                      - [x] "自用"（橙）: 使用状況 → "自用"
                      - [x] "収益不動産"（緑）: 使用状況 → "賃貸（住居）", "賃貸（住居以外）", "賃貸（不明）", "底地"
                      - [x] "駐車場・更地"（青）: 使用状況 → "駐車場", "更地"
                      - [x] "その他"（紫）: 使用状況 → "未選択", "生産緑地", "その他"
                - [x] 使用状況
                    - [x] "未選択"の場合、ブランクで表示される。
                    - [x] "自用", "賃貸（住居）", "賃貸（住居以外）", "賃貸（不明）", "底地", "駐車場", "更地", "生産緑地", "その他"が表示される。
                - [x] 種類
                    - [x] "未選択"の場合、ブランクで表示される。
                    - [x] "自用", "土地", "建物", "土地付建物", "マンション", "その他"が表示される。
                - [x] 所在地
                    - [x] 存在しない場合はブランクで表示される。
                    - [x] 存在する場合は、対象の所在地が表示される。
                    - [x] 文字の全長が、表示領域を超える場合、三点リードの領域を含んだ文字数分が表示される。例:  1234567890123456789012345678901234銀...
                - [x] 評価額
                    - [x] 存在しない場合はブランクで表示される。
                    - [x] 存在する場合は対象の金額が"万円"単位で小数点第一位まで表示される。
                - [x] アコーディオンボタン
                    - [x] タップすると、シェブロンが180度反転し"面積", "担保設定", "備考"が表示される。
                    - [x] "備考"が表示された状態で再度タップすると、シェブロンが戻り、"面積", "担保設定", "備考"が隠れる。
                - [x] 面積
                    - [x] アコーディオンボタンがタップされると出現する。
                    - [x] 存在しない場合はブランクで表示される。
                    - [x] 存在する場合は"㎡"の単位で小数点第二位まで表示される。
                - [x] 担保設定
                    - [x] アコーディオンボタンがタップされると出現する。
                    - [x] "未選択"の場合、ブランクで表示される。
                    - [x] "有り", "無し"が表示される。
                - [x] 備考
                    - [x] アコーディオンボタンがタップされると出現する。
                    - [x] 存在する場合は、対象の備考が表示される。
                    - [x] 備考の記載、全文が確認できる
                    - [x] 文字数に合わせてテキストエリアの高さが変わる
                    - [x] 改行が正しく表示される。
                - [x] 削除ボタン
                    - [x] マイナスサークルボタンをタップすると出現する。
                    - [x] 明細を右から左にスワイプすると出現する。
                    - [x] 削除ボタンが表示された状態で明細がタップすると非表示になる。
                    - [x] タップすると[削除ボタンをタップ](#削除ボタンをタップ)を実行する。
            - [x] 合計金額情報
                - [x] 各明細の金額の合計額が"万円"単位で小数点第一位まで表示される。
                - [x] 明細のうち金額が存在しないものは加算されない。
4. 相続税計算
    - [x] タップすると、[相続税計算](#相続税計算ボタンをタップ) を実行する。

## イベント

この項では、当画面にて実行されるイベント一覧を記述する。

### 資産負債収入情報トップ画面への遷移

- [x] 資産負債収入情報トップ画面に遷移する。

### 個人CRMへの遷移

- [x] 個人CRM（他システム）に遷移する。

### 追加ボタンをタップ

- [x] 明細追加・編集ダイアログ（不動産）に遷移する。

### 削除ボタンをタップ

- [x] ポップアップメッセージ「(タイトル)明細を削除します。(本文)この操作は取り消すことができません。(キャンセル/削除)」が表示される。
- [x] ポップアップメッセージに対して、削除をタップすると 該当の明細が削除され、該当分類の合計金額を集計、表示する。
- [x] ポップアップメッセージに対して、キャンセルをタップすると当画面(編集モード)に戻る。

### 相続税計算ボタンをタップ

[相続税簡易シミュレーション入力](../相続税簡易シミュレーション/相続税簡易シミュレーション入力.md)を表示する。
